<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Muchacho</title>
    <style>
      .target {
        width: 200px;
        height: 200px;
        background-color: gray;
      }

      .success {
        background-color: green;
      }

      .failure {
        background-color: red;
      }
    </style>
  </head>
  <body>
    <h1>Muchacho</h1>
    <div id="target" class="target" ondrop="handleChange(event)" ondragover="handleDragover(event)"></div>

    <script>
      function handleDragover(event) {
        // console.debug(event);
        event.preventDefault();
      }

      function handleChange(event) {
        // console.debug(event);
        event.preventDefault();
        const url = event.dataTransfer.getData("text");
        console.debug("url", url);

        const params = {
          method: "POST",
          body: JSON.stringify({"url": url}),
          headers: {"Content-Type": "application/json"},
        };
        const target = document.querySelector("#target");
        fetch("http://localhost:8088/add", params)
          .then(response => {
            target.classList.add("success");
            setTimeout(() => target.classList.remove("success"), 1000);
          })
          .catch(error => {
            console.debug("error", error);
            target.classList.add("failure");
            setTimeout(() => target.classList.remove("failure"), 1000);
          });
      }
    </script>
  </body>
</html>
